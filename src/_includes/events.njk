<ul class="events">
	{% for event in events %}
		<li class="event" data-startTime="{{event.startTime}}" data-endTime="{{event.endTime}}" data-sports="{{event.sport}}" data-peacock-only="{{event.network == 'Peacock'}}" data-medal="{{event.medal}}" data-usa="{{event.usa}}">
			<div class="image-container">
				<p class="live" style="display: none;">Live</p>
				<p class="time">{{event.duration}}</p>
				<img class="event-img{% if event.medal %} gold{% endif %}" src={{event.img}} width="{{event.imgWidth}}" height="{{event.imgHeight}}" alt="{{event.imgAlt | default('') | escape }}">
			</div>
			<div class="text">
				<div class="title">
					<h3>{{event.sport}}{% if event.medal %} ðŸ¥‡{% endif %}{% if event.usa %} ðŸ‡ºðŸ‡¸{% endif %}</h3>
					<h2>{{event.title}}</h2>
					<p>{% if tomorrow %}Tomorrow, {% endif %}<b>{{event.time}}</b> on <b>{{event.network}}</b></p>
				</div>
				<div class="watch">
					<img class="network-logo" src={{event.networkLogo}} width="{{event.networkLogoWidth}}" height="{{event.networkLogoHeight}}" alt="{{event.network}} Logo">
				</div>
				<div class="details">
					<p class="small light summary">{{event.summary}}</p>
					{% if event.rundown.items %}
						{% for item in event.rundown.items %}
							<div class="schedule-item">
								<p>{% if item.date %}{% if tomorrow %}Tomorrow, {% endif %}<b>{{item.displayTime}}{% if item.timeAdjusted %}*{% endif %}</b> - {% endif %}{{item.header | boldSport | safe}}</p>
								<p class="small light">{{item.description}}</p>
							</div>
						{% endfor %}
						{% if event.rundown.timeAdjusted %}<p class="small light">*Times are adjusted from EST but it's impossible to know if the program is actually delayed for pacific viewers.</p>{% endif %}
					{% endif %}
				</div>
			</div>
		</li>
	{% else %}
		<p>No Events Found</p>
	{% endfor %}
</ul>
<script>
  const now = Math.floor(Date.now() / 1000);

  document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('.events .event').forEach(event => {
      const startTime = event.getAttribute('data-startTime')
      const endTime = event.getAttribute('data-endTime')

      if (endTime < now) {
        event.style.display = 'none'
      } else if (now >= startTime && now < endTime) {
        event.querySelector('.live').style.display = ''
      }
    });
  });
</script>